\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdftitle={JatApp - Marketing Analysis},
            pdfauthor={Andrei Kristov},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{JatApp - Marketing Analysis}
\author{Andrei Kristov}
\date{11/14/2021}

\begin{document}
\maketitle

\hypertarget{jatapp---marketing-analysis.-data-preparation}{%
\section{JatApp - Marketing Analysis. Data
preparation}\label{jatapp---marketing-analysis.-data-preparation}}

\hypertarget{load-data}{%
\subsection{Load data}\label{load-data}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#load data}
\NormalTok{market_data <-}\StringTok{ }\KeywordTok{as_tibble}\NormalTok{(}\KeywordTok{read.csv}\NormalTok{(}\StringTok{"/Users/Andrew/Documents/R/data/JatApp - Marketing analysis/marketing_data.csv"}\NormalTok{, }\DataTypeTok{encoding =} \StringTok{"utf-8"}\NormalTok{))}

\KeywordTok{head}\NormalTok{(market_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 28
##      ID Year_Birth Education Marital_Status Income Kidhome Teenhome Dt_Customer
##   <int>      <int> <fct>     <fct>          <fct>    <int>    <int> <fct>      
## 1  1826       1970 Graduati~ Divorced       "$84,~       0        0 6/16/14    
## 2     1       1961 Graduati~ Single         "$57,~       0        0 6/15/14    
## 3 10476       1958 Graduati~ Married        "$67,~       0        1 5/13/14    
## 4  1386       1967 Graduati~ Together       "$32,~       1        1 5/11/14    
## 5  5371       1989 Graduati~ Single         "$21,~       1        0 4/8/14     
## 6  7348       1958 PhD       Single         "$71,~       0        0 3/17/14    
## # ... with 20 more variables: Recency <int>, MntWines <int>, MntFruits <int>,
## #   MntMeatProducts <int>, MntFishProducts <int>, MntSweetProducts <int>,
## #   MntGoldProds <int>, NumDealsPurchases <int>, NumWebPurchases <int>,
## #   NumCatalogPurchases <int>, NumStorePurchases <int>,
## #   NumWebVisitsMonth <int>, AcceptedCmp3 <int>, AcceptedCmp4 <int>,
## #   AcceptedCmp5 <int>, AcceptedCmp1 <int>, AcceptedCmp2 <int>, Response <int>,
## #   Complain <int>, Country <fct>
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{str}\NormalTok{(market_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Classes 'tbl_df', 'tbl' and 'data.frame':    2240 obs. of  28 variables:
##  $ ID                 : int  1826 1 10476 1386 5371 7348 4073 1991 4047 9477 ...
##  $ Year_Birth         : int  1970 1961 1958 1967 1989 1958 1954 1967 1954 1954 ...
##  $ Education          : Factor w/ 5 levels "2n Cycle","Basic",..: 3 3 3 3 3 5 1 3 5 5 ...
##  $ Marital_Status     : Factor w/ 8 levels "Absurd","Alone",..: 3 5 4 6 5 5 4 6 4 4 ...
##  $ Income             : Factor w/ 1975 levels "","$1,730.00 ",..: 1891 1141 1447 395 122 1579 1332 790 1388 1388 ...
##  $ Kidhome            : int  0 0 0 1 1 0 0 0 0 0 ...
##  $ Teenhome           : int  0 0 1 1 0 0 0 1 1 1 ...
##  $ Dt_Customer        : Factor w/ 663 levels "1/1/13","1/1/14",..: 473 471 410 406 398 298 40 18 6 6 ...
##  $ Recency            : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ MntWines           : int  189 464 134 10 6 336 769 78 384 384 ...
##  $ MntFruits          : int  104 5 11 0 16 130 80 0 0 0 ...
##  $ MntMeatProducts    : int  379 64 59 1 24 411 252 11 102 102 ...
##  $ MntFishProducts    : int  111 7 15 0 11 240 15 0 21 21 ...
##  $ MntSweetProducts   : int  189 0 2 0 0 32 34 0 32 32 ...
##  $ MntGoldProds       : int  218 37 30 0 34 43 65 7 5 5 ...
##  $ NumDealsPurchases  : int  1 1 1 1 2 1 1 1 3 3 ...
##  $ NumWebPurchases    : int  4 7 3 1 3 4 10 2 6 6 ...
##  $ NumCatalogPurchases: int  4 3 2 0 1 7 10 1 2 2 ...
##  $ NumStorePurchases  : int  6 7 5 2 2 5 7 3 9 9 ...
##  $ NumWebVisitsMonth  : int  1 5 2 7 7 2 6 5 4 4 ...
##  $ AcceptedCmp3       : int  0 0 0 0 1 0 1 0 0 0 ...
##  $ AcceptedCmp4       : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ AcceptedCmp5       : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ AcceptedCmp1       : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ AcceptedCmp2       : int  0 1 0 0 0 0 0 0 0 0 ...
##  $ Response           : int  1 1 0 0 1 1 1 0 0 0 ...
##  $ Complain           : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Country            : Factor w/ 8 levels "AUS","CA","GER",..: 7 2 8 1 7 7 3 7 8 4 ...
\end{verbatim}

\hypertarget{transform-data}{%
\subsection{Transform data}\label{transform-data}}

Income from string to numeric, Dt\_Customer to Date, 3,4,21:28 fields -
to factors.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# assign data types to columns}
\NormalTok{market_data[,}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{21}\OperatorTok{:}\DecValTok{28}\NormalTok{)] <-}\StringTok{  }\KeywordTok{lapply}\NormalTok{(market_data[,}\KeywordTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{21}\OperatorTok{:}\DecValTok{28}\NormalTok{)],factor)}
\NormalTok{market_data}\OperatorTok{$}\NormalTok{Income <-}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(}\KeywordTok{gsub}\NormalTok{(}\StringTok{"[$,]"}\NormalTok{,}\StringTok{""}\NormalTok{,market_data}\OperatorTok{$}\NormalTok{Income))}
\NormalTok{market_data}\OperatorTok{$}\NormalTok{Dt_Customer <-}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(market_data}\OperatorTok{$}\NormalTok{Dt_Customer,}\StringTok{"%m/%d/%y"}\NormalTok{)}
\KeywordTok{str}\NormalTok{(market_data) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Classes 'tbl_df', 'tbl' and 'data.frame':    2240 obs. of  28 variables:
##  $ ID                 : int  1826 1 10476 1386 5371 7348 4073 1991 4047 9477 ...
##  $ Year_Birth         : int  1970 1961 1958 1967 1989 1958 1954 1967 1954 1954 ...
##  $ Education          : Factor w/ 5 levels "2n Cycle","Basic",..: 3 3 3 3 3 5 1 3 5 5 ...
##  $ Marital_Status     : Factor w/ 8 levels "Absurd","Alone",..: 3 5 4 6 5 5 4 6 4 4 ...
##  $ Income             : num  84835 57091 67267 32474 21474 ...
##  $ Kidhome            : int  0 0 0 1 1 0 0 0 0 0 ...
##  $ Teenhome           : int  0 0 1 1 0 0 0 1 1 1 ...
##  $ Dt_Customer        : Date, format: "2014-06-16" "2014-06-15" ...
##  $ Recency            : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ MntWines           : int  189 464 134 10 6 336 769 78 384 384 ...
##  $ MntFruits          : int  104 5 11 0 16 130 80 0 0 0 ...
##  $ MntMeatProducts    : int  379 64 59 1 24 411 252 11 102 102 ...
##  $ MntFishProducts    : int  111 7 15 0 11 240 15 0 21 21 ...
##  $ MntSweetProducts   : int  189 0 2 0 0 32 34 0 32 32 ...
##  $ MntGoldProds       : int  218 37 30 0 34 43 65 7 5 5 ...
##  $ NumDealsPurchases  : int  1 1 1 1 2 1 1 1 3 3 ...
##  $ NumWebPurchases    : int  4 7 3 1 3 4 10 2 6 6 ...
##  $ NumCatalogPurchases: int  4 3 2 0 1 7 10 1 2 2 ...
##  $ NumStorePurchases  : int  6 7 5 2 2 5 7 3 9 9 ...
##  $ NumWebVisitsMonth  : int  1 5 2 7 7 2 6 5 4 4 ...
##  $ AcceptedCmp3       : Factor w/ 2 levels "0","1": 1 1 1 1 2 1 2 1 1 1 ...
##  $ AcceptedCmp4       : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
##  $ AcceptedCmp5       : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
##  $ AcceptedCmp1       : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
##  $ AcceptedCmp2       : Factor w/ 2 levels "0","1": 1 2 1 1 1 1 1 1 1 1 ...
##  $ Response           : Factor w/ 2 levels "0","1": 2 2 1 1 2 2 2 1 1 1 ...
##  $ Complain           : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...
##  $ Country            : Factor w/ 8 levels "AUS","CA","GER",..: 7 2 8 1 7 7 3 7 8 4 ...
\end{verbatim}

\hypertarget{missing-values}{%
\subsection{Missing values}\label{missing-values}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Missing values}
\CommentTok{#skimr::skim(market_data)}
\NormalTok{missing_values <-}\StringTok{ }\NormalTok{market_data }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summarize_all}\NormalTok{(}\KeywordTok{funs}\NormalTok{(}\KeywordTok{sum}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(.))}\OperatorTok{/}\KeywordTok{n}\NormalTok{()))}
\CommentTok{#head(missing_values)}
\NormalTok{missing_values <-}\StringTok{ }\KeywordTok{gather}\NormalTok{(missing_values, }\DataTypeTok{key =} \StringTok{"feature"}\NormalTok{, }\DataTypeTok{value =} \StringTok{"missing_pct"}\NormalTok{)}
\KeywordTok{head}\NormalTok{(missing_values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 2
##   feature        missing_pct
##   <chr>                <dbl>
## 1 ID                  0     
## 2 Year_Birth          0     
## 3 Education           0     
## 4 Marital_Status      0     
## 5 Income              0.0107
## 6 Kidhome             0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{missing_values }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{reorder}\NormalTok{(feature, missing_pct), }\DataTypeTok{y =}\NormalTok{ missing_pct)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{, }\DataTypeTok{fill =} \StringTok{'red'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{theme_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{JatApp-Marketing-analysis_files/figure-latex/unnamed-chunk-4-1.pdf}

Conclusion: MIssing values in Income.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Impute Income with median by Country+Education}
\NormalTok{market_data_fixed <-}\StringTok{ }
\StringTok{  }\NormalTok{market_data }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{group_by}\NormalTok{(Country, Education) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{Income_fixed =} \KeywordTok{ifelse}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(Income),}
                               \KeywordTok{median}\NormalTok{(Income, }\DataTypeTok{na.rm =}\NormalTok{ T),}
\NormalTok{                               Income))}

\CommentTok{# check}
\CommentTok{# 1 manually, equallity with group median}
\NormalTok{market_data }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{group_by}\NormalTok{(Country, Education) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{summarise}\NormalTok{(}\KeywordTok{median}\NormalTok{(Income,}\DataTypeTok{na.rm =}\NormalTok{ T))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `summarise()` has grouped output by 'Country'. You can override using the `.groups` argument.
\end{verbatim}

\begin{verbatim}
## # A tibble: 38 x 3
## # Groups:   Country [8]
##    Country Education  `median(Income, na.rm = T)`
##    <fct>   <fct>                            <dbl>
##  1 AUS     2n Cycle                        40180 
##  2 AUS     Basic                           22256.
##  3 AUS     Graduation                      56796 
##  4 AUS     Master                          53367 
##  5 AUS     PhD                             48948 
##  6 CA      2n Cycle                        46116.
##  7 CA      Basic                           20425 
##  8 CA      Graduation                      52113 
##  9 CA      Master                          54348 
## 10 CA      PhD                             59187 
## # ... with 28 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{market_data_fixed }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(Income)) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{select}\NormalTok{(}\KeywordTok{c}\NormalTok{(Education,Income, Country, Income_fixed))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 24 x 4
## # Groups:   Country, Education [14]
##    Education  Income Country Income_fixed
##    <fct>       <dbl> <fct>          <dbl>
##  1 PhD            NA GER           61426.
##  2 Graduation     NA US            55801 
##  3 PhD            NA AUS           48948 
##  4 Graduation     NA AUS           56796 
##  5 PhD            NA CA            59187 
##  6 2n Cycle       NA GER           35523 
##  7 Master         NA US            47570 
##  8 Graduation     NA GER           57160.
##  9 2n Cycle       NA AUS           40180 
## 10 Master         NA AUS           53367 
## # ... with 14 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# 2}
\KeywordTok{sum}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(market_data_fixed}\OperatorTok{$}\NormalTok{Income_fixed))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0
\end{verbatim}

\hypertarget{save-file-for-use-in-power-bi}{%
\subsection{Save file for use in Power
BI}\label{save-file-for-use-in-power-bi}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#write_csv(market_data_fixed,file = "/Users/Andrew/Documents/R/data/JatApp - Marketing analysis/marketing_data_fixed.csv")}
\end{Highlighting}
\end{Shaded}

\hypertarget{outliers}{%
\subsection{Outliers}\label{outliers}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Outliers}
\KeywordTok{summary}\NormalTok{(market_data_fixed) }\CommentTok{# outliers in income & income_fixed}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        ID          Year_Birth        Education     Marital_Status
##  Min.   :    0   Min.   :1893   2n Cycle  : 203   Married :864   
##  1st Qu.: 2828   1st Qu.:1959   Basic     :  54   Together:580   
##  Median : 5458   Median :1970   Graduation:1127   Single  :480   
##  Mean   : 5592   Mean   :1969   Master    : 370   Divorced:232   
##  3rd Qu.: 8428   3rd Qu.:1977   PhD       : 486   Widow   : 77   
##  Max.   :11191   Max.   :1996                     Alone   :  3   
##                                                   (Other) :  4   
##      Income          Kidhome          Teenhome       Dt_Customer        
##  Min.   :  1730   Min.   :0.0000   Min.   :0.0000   Min.   :2012-07-30  
##  1st Qu.: 35303   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:2013-01-16  
##  Median : 51382   Median :0.0000   Median :0.0000   Median :2013-07-08  
##  Mean   : 52247   Mean   :0.4442   Mean   :0.5062   Mean   :2013-07-10  
##  3rd Qu.: 68522   3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:2013-12-30  
##  Max.   :666666   Max.   :2.0000   Max.   :2.0000   Max.   :2014-06-29  
##  NA's   :24                                                             
##     Recency         MntWines         MntFruits     MntMeatProducts 
##  Min.   : 0.00   Min.   :   0.00   Min.   :  0.0   Min.   :   0.0  
##  1st Qu.:24.00   1st Qu.:  23.75   1st Qu.:  1.0   1st Qu.:  16.0  
##  Median :49.00   Median : 173.50   Median :  8.0   Median :  67.0  
##  Mean   :49.11   Mean   : 303.94   Mean   : 26.3   Mean   : 166.9  
##  3rd Qu.:74.00   3rd Qu.: 504.25   3rd Qu.: 33.0   3rd Qu.: 232.0  
##  Max.   :99.00   Max.   :1493.00   Max.   :199.0   Max.   :1725.0  
##                                                                    
##  MntFishProducts  MntSweetProducts  MntGoldProds    NumDealsPurchases
##  Min.   :  0.00   Min.   :  0.00   Min.   :  0.00   Min.   : 0.000   
##  1st Qu.:  3.00   1st Qu.:  1.00   1st Qu.:  9.00   1st Qu.: 1.000   
##  Median : 12.00   Median :  8.00   Median : 24.00   Median : 2.000   
##  Mean   : 37.53   Mean   : 27.06   Mean   : 44.02   Mean   : 2.325   
##  3rd Qu.: 50.00   3rd Qu.: 33.00   3rd Qu.: 56.00   3rd Qu.: 3.000   
##  Max.   :259.00   Max.   :263.00   Max.   :362.00   Max.   :15.000   
##                                                                      
##  NumWebPurchases  NumCatalogPurchases NumStorePurchases NumWebVisitsMonth
##  Min.   : 0.000   Min.   : 0.000      Min.   : 0.00     Min.   : 0.000   
##  1st Qu.: 2.000   1st Qu.: 0.000      1st Qu.: 3.00     1st Qu.: 3.000   
##  Median : 4.000   Median : 2.000      Median : 5.00     Median : 6.000   
##  Mean   : 4.085   Mean   : 2.662      Mean   : 5.79     Mean   : 5.317   
##  3rd Qu.: 6.000   3rd Qu.: 4.000      3rd Qu.: 8.00     3rd Qu.: 7.000   
##  Max.   :27.000   Max.   :28.000      Max.   :13.00     Max.   :20.000   
##                                                                          
##  AcceptedCmp3 AcceptedCmp4 AcceptedCmp5 AcceptedCmp1 AcceptedCmp2 Response
##  0:2077       0:2073       0:2077       0:2096       0:2210       0:1906  
##  1: 163       1: 167       1: 163       1: 144       1:  30       1: 334  
##                                                                           
##                                                                           
##                                                                           
##                                                                           
##                                                                           
##  Complain    Country      Income_fixed   
##  0:2219   SP     :1095   Min.   :  1730  
##  1:  21   SA     : 337   1st Qu.: 35523  
##           CA     : 268   Median : 51412  
##           AUS    : 160   Mean   : 52246  
##           IND    : 148   3rd Qu.: 68290  
##           GER    : 120   Max.   :666666  
##           (Other): 112
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#explore outliers by marital status}
\NormalTok{market_data_fixed }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(Marital_Status, Income_fixed) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(Marital_Status, Income_fixed, }\DataTypeTok{fill=}\NormalTok{Marital_Status)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_boxplot}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_brewer}\NormalTok{(}\DataTypeTok{palette =} \StringTok{"Set3"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Adding missing grouping variables: `Country`, `Education`
\end{verbatim}

\includegraphics{JatApp-Marketing-analysis_files/figure-latex/unnamed-chunk-7-1.pdf}

Explore outliers by country:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#explore outliers by country}
\NormalTok{market_data_fixed }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{select}\NormalTok{(Country, Income_fixed) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(Country, Income_fixed, }\DataTypeTok{fill=}\NormalTok{Country)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_boxplot}\NormalTok{() }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_fill_brewer}\NormalTok{(}\DataTypeTok{palette =} \StringTok{"Set3"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_y_continuous}\NormalTok{(}\DataTypeTok{labels =}\NormalTok{ scales}\OperatorTok{::}\NormalTok{dollar)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Adding missing grouping variables: `Education`
\end{verbatim}

\includegraphics{JatApp-Marketing-analysis_files/figure-latex/unnamed-chunk-8-1.pdf}

Coclusion: Outliers among Together in SA. Let's leave them.

\hypertarget{prepare-pivoted-dataset-for-visualization-in-power-bi}{%
\subsection{Prepare pivoted dataset for visualization in Power
BI}\label{prepare-pivoted-dataset-for-visualization-in-power-bi}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# pivot data on products to investigate shares sold}
\NormalTok{market_data_fixed_pivoted <-}\StringTok{ }\NormalTok{market_data_fixed }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{pivot_longer}\NormalTok{(}\DataTypeTok{cols =} \KeywordTok{starts_with}\NormalTok{(}\StringTok{"Mnt"}\NormalTok{), }\DataTypeTok{names_to =} \StringTok{"Products"}\NormalTok{, }\DataTypeTok{values_to =} \StringTok{"Amount"}\NormalTok{)}
\CommentTok{# rename}
\NormalTok{market_data_fixed_pivoted <-}\StringTok{ }\NormalTok{market_data_fixed_pivoted }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{Products =} \KeywordTok{case_when}\NormalTok{(}
\NormalTok{    Products }\OperatorTok{==}\StringTok{ "MntWines"} \OperatorTok{~}\StringTok{ "Wines"}\NormalTok{,}
\NormalTok{    Products }\OperatorTok{==}\StringTok{ "MntMeatProducts"} \OperatorTok{~}\StringTok{ "Meat"}\NormalTok{,}
\NormalTok{    Products }\OperatorTok{==}\StringTok{ "MntSweetProducts"} \OperatorTok{~}\StringTok{ "Sweet"}\NormalTok{,}
\NormalTok{    Products }\OperatorTok{==}\StringTok{ "MntFruits"} \OperatorTok{~}\StringTok{ "Fruits"}\NormalTok{,}
\NormalTok{    Products }\OperatorTok{==}\StringTok{ "MntFishProducts"} \OperatorTok{~}\StringTok{ "Fish"}\NormalTok{,}
\NormalTok{    Products }\OperatorTok{==}\StringTok{ "MntGoldProds"} \OperatorTok{~}\StringTok{ "Gold"}\NormalTok{,}
\NormalTok{  ))}
\KeywordTok{head}\NormalTok{(market_data_fixed_pivoted)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 25
## # Groups:   Country, Education [1]
##      ID Year_Birth Education Marital_Status Income Kidhome Teenhome Dt_Customer
##   <int>      <int> <fct>     <fct>           <dbl>   <int>    <int> <date>     
## 1  1826       1970 Graduati~ Divorced        84835       0        0 2014-06-16 
## 2  1826       1970 Graduati~ Divorced        84835       0        0 2014-06-16 
## 3  1826       1970 Graduati~ Divorced        84835       0        0 2014-06-16 
## 4  1826       1970 Graduati~ Divorced        84835       0        0 2014-06-16 
## 5  1826       1970 Graduati~ Divorced        84835       0        0 2014-06-16 
## 6  1826       1970 Graduati~ Divorced        84835       0        0 2014-06-16 
## # ... with 17 more variables: Recency <int>, NumDealsPurchases <int>,
## #   NumWebPurchases <int>, NumCatalogPurchases <int>, NumStorePurchases <int>,
## #   NumWebVisitsMonth <int>, AcceptedCmp3 <fct>, AcceptedCmp4 <fct>,
## #   AcceptedCmp5 <fct>, AcceptedCmp1 <fct>, AcceptedCmp2 <fct>, Response <fct>,
## #   Complain <fct>, Country <fct>, Income_fixed <dbl>, Products <chr>,
## #   Amount <int>
\end{verbatim}

\hypertarget{save-pivoted-dataset-for-calculation-in-power-bi}{%
\subsection{Save pivoted dataset for calculation in Power
BI}\label{save-pivoted-dataset-for-calculation-in-power-bi}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# save }
\CommentTok{#write.csv(market_data_fixed_pivoted,file = "/Users/Andrew/Documents/R/data/JatApp - Marketing analysis/marketing_data_fixed_pivoted.csv")}
\end{Highlighting}
\end{Shaded}

\hypertarget{fields-investigation}{%
\subsection{Fields investigation}\label{fields-investigation}}

Histograms of all numeric values

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# histograms of all numeric values}
\NormalTok{market_data_fixed_numeric <-}\StringTok{ }\NormalTok{market_data_fixed[,}\KeywordTok{sapply}\NormalTok{(market_data_fixed, is.numeric)]}
\NormalTok{market_data_fixed_numeric }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{pivot_longer}\NormalTok{(}\DataTypeTok{cols =} \KeywordTok{everything}\NormalTok{(), }\DataTypeTok{names_to=}\StringTok{"key"}\NormalTok{, }\DataTypeTok{values_to=}\StringTok{"value"}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(value)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{facet_wrap}\NormalTok{(}\OperatorTok{~}\NormalTok{key, }\DataTypeTok{scales =} \StringTok{"free"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_histogram}\NormalTok{()  }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\includegraphics{JatApp-Marketing-analysis_files/figure-latex/unnamed-chunk-11-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# boxplots of all numeric values}
\NormalTok{market_data_fixed_numeric }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{pivot_longer}\NormalTok{(}\DataTypeTok{cols =} \KeywordTok{everything}\NormalTok{(), }\DataTypeTok{names_to=}\StringTok{"key"}\NormalTok{, }\DataTypeTok{values_to=}\StringTok{"value"}\NormalTok{) }\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(value)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{facet_wrap}\NormalTok{(}\OperatorTok{~}\NormalTok{key, }\DataTypeTok{scales =} \StringTok{"free"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_boxplot}\NormalTok{() }
\end{Highlighting}
\end{Shaded}

\includegraphics{JatApp-Marketing-analysis_files/figure-latex/unnamed-chunk-11-2.pdf}

Conclusions: It seems that all distributions are skewed: need to be
checked for normality in case of hypothesis check. There are outliers in
Income\_fixed, Mnt and Num variables, Year\_Birth -\textgreater{} can be
imputed to make distribution more normal

\hypertarget{correlation}{%
\subsection{Correlation}\label{correlation}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# correlation}
\KeywordTok{library}\NormalTok{(corrplot)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## corrplot 0.84 loaded
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(RColorBrewer)}
\KeywordTok{corrplot}\NormalTok{(}\DataTypeTok{corr =} \KeywordTok{cor}\NormalTok{(market_data_fixed_numeric),}
         \DataTypeTok{type =} \StringTok{"upper"}\NormalTok{,}
         \DataTypeTok{col =} \KeywordTok{brewer.pal}\NormalTok{(}\DataTypeTok{n=}\KeywordTok{length}\NormalTok{(}\KeywordTok{names}\NormalTok{(market_data_fixed_numeric)),}\DataTypeTok{name =} \StringTok{"RdYlBu"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{JatApp-Marketing-analysis_files/figure-latex/unnamed-chunk-12-1.pdf}

Conclusion: Variables with strong correlation should be explored more
thoroughly.

\end{document}
